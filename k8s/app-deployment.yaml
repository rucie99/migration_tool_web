apiVersion: v1
kind: Namespace
metadata:
  name: mssql-exporter
---
# 1. Secret (DB 접속 정보는 서버에서 직접 생성할 것이므로 껍데기만 정의하거나 참조만 함)
# 실제 비밀번호는 git에 올리지 않습니다.
apiVersion: apps/v1
kind: Deployment
metadata:
  name: excel-exporter
  namespace: mssql-exporter
spec:
  replicas: 1
  selector:
    matchLabels:
      app: excel-exporter
  template:
    metadata:
      labels:
        app: excel-exporter
    spec:
      containers:
      - name: exporter
        # [수정 필요] 본인의 깃허브 아이디와 레포지토리 이름으로 변경하세요
        # 예: image: ghcr.io/honggildong/mssql-project:latest
        image: ghcr.io/rucie99/migration_tool_web:latest
        imagePullPolicy: Always
        envFrom:
        - secretRef:
            name: db-secrets
        volumeMounts:
        - name: output-volume
          mountPath: /app/output
      volumes:
      - name: output-volume
        hostPath:
          # 서버(Minikube)의 저장 경로 (필요시 수정)
          path: /data/excel-output
          type: DirectoryOrCreate