version: "3.9"

services:
  mig-tool:                                   # 서비스 이름 자유롭게 변경 가능
    build:
      context: .                             # Dockerfile이 있는 디렉토리
      dockerfile: Dockerfile                 # 위에서 만든 Dockerfile 그대로 사용
    container_name: my-app                   # (선택) 고정 컨테이너 이름
    restart: unless-stopped                  # 핵심: 이 한 줄이면 끝!
    # restart 정책 상세 설명
    # - no                : 재시작 안 함 (기본값)
    # - on-failure        : 비정상 종료(exit code ≠ 0)일 때만 재시작
    # - always            : 무조건 재시작 (심지어 docker stop 해도 다시 살아남)
    # - unless-stopped    : 강제로 멈추지 않는 한 (docker stop, docker compose down) 무조건 재시작 ← 실무 99%가 이거 씁니다

    ports:
      - "5000:5000"                          # Flask 등 5000번 포트 노출 시

    environment:                             # 필요 시 환경변수 추가
      - TZ=Asia/Seoul


    # (선택) 로그 설정 – 너무 커지는 것 방지
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"
